<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      contentType="text/html"
      xmlns:ezcomp="http://java.sun.com/jsf/composite/ezcomp">

    <body>

        <ui:composition template="/mainTemplate.xhtml">

            <ui:define name="titulo">
                Enviar aviso de incidencia
            </ui:define>
            
            <ui:define name="botonesBarra">
                <ezcomp:boton_barra_superior classIcon="ui-icon-home" title="Ir al inicio" action="#{autenticadorMB.goToIndex()}" />
                <ezcomp:boton_barra_superior classIcon="ui-icon-back" title="Seleccionar punto limpio" action="#{autenticadorMB.goToEnviarAvisoIncidencia()}" />
            </ui:define>
            
            <ui:define name="centro">
                <h:form  enctype="multipart/form-data">
                    <h:inputHidden value="#{enviarAvisoIncidenciaMB.numPuntoLimpio}"/>
                    
                    <p:panelGrid columns="2" styleClass="centrar">
                        <f:facet name="header">Ingresar datos del aviso de incidencia</f:facet>
                        
                        <p:outputLabel value="Punto limpio" for="nombre_ptoLimpio"/>
                        <p:inputText id="nombre_ptoLimpio" value="#{enviarAvisoIncidenciaMB.nombre_presentacion_ptoLimpio}" disabled="true"/>
                        
                        <p:outputLabel for="selectOneMenu" value="Seleccione tipo de incidencia"/>
                        <h:selectOneMenu id="selectOneMenu" value="#{enviarAvisoIncidenciaMB.tipoIncidenciaSeleccionada}" >
                            <f:selectItems value="#{enviarAvisoIncidenciaMB.listaTiposIncidencias}" var="t_incid" itemValue="#{t_incid.id}" itemLabel="#{t_incid.label}"/>
                        </h:selectOneMenu>
                        
                        <p:outputLabel value="Escribir detalles" for="detalles"/>
                        <p:inputTextarea id="detalles" value="#{enviarAvisoIncidenciaMB.detalles}" required="true"/>
                        
                        <p:outputLabel value="E-mail de contacto" for="email"/>
                        <p:inputText id="email" value="#{enviarAvisoIncidenciaMB.emailContacto}" >
                            <f:validator validatorId="EmailValidator"/>
                        </p:inputText>
                        
                        
                        <p:outputLabel for="subidaArchivos" value="Subir imagen"/>
                        
                        <p:outputPanel><!-- Máximo de 16Mb y sólo imágenes -->
                            <p:fileUpload id="subidaArchivos" value="#{enviarAvisoIncidenciaMB.file}" 
                                    mode="simple" sizeLimit="16777216" 
                                    allowTypes="/(\.|\/)(gif|jpg|jpeg|gif|png|PNG|GIF|JPG|JPEG)$/"
                                    required="false" label="Subir imagen"/> 
                        </p:outputPanel>
                        
                        <p:outputLabel for="captcha" value="Escriba las dos palabras"/>
                        <p:captcha id="captcha" theme="white" language="es"/>
                        
                        <f:facet name="footer">
                            <p:commandButton value="Enviar" ajax="false" action="#{enviarAvisoIncidenciaMB.enviarAviso()}"/>
                            <p:commandButton immediate="true" value="Cancelar" action="#{autenticadorMB.goToIndex()}"/>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
                
            </ui:define>

        </ui:composition>

    </body>
</html>
